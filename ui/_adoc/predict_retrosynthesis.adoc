= RXN for Chemistry - Predict retrosynthesis
:docinfo: shared
:icons: font
:showtitle!:
:nofooter:
:source-highlighter: rouge

link:index.html[icon:arrow-circle-left[2x]  Return to RXN for Chemistry Documentation]

[discrete]
== {doctitle}

This guide is a tutorial to learn how to predict a retrosynthesis using RXN for Chemistry.
////
NOTE: IBM, the IBM logo, and ibm.comÂ® are trademarks or registered trademarks of IBM Corporation, registered in many jurisdictions worldwide. Other product and service names might be trademarks of IBM or other companies. A current list of IBM trademarks is available here: https://www.ibm.com/legal/copyright-trademark[Copyright and Trademark Information].
////
.*Start Tutorial*
[%collapsible]
=======
---
IMPORTANT: An RXN for Chemistry account is required to complete this tutorial.

[NOTE]
====
* Number of steps in this tutorial: *28*
* Estimated time to complete this tutorial: *15 minutes*
====
---

.*Step 1:* Log into RXN for Chemistry
[%collapsible]
====
TIP: See our link:./quick_start.html[RXN for Chemistry Quick Start] for directions on logging into the RXN for Chemistry system.
====

.*Step 2:* From the RXN for Chemistry Home screen, click "Predict retrosynthetic routes"
[%collapsible]
====
image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-06/8b7899ae-8d2a-4f8c-92bd-98635c30c582/ascreenshot.jpeg?tl_px=309,0&br_px=1169,480&force_format=png&width=860&wat_scale=76&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=402,198[Screenshot of: Click "Predict retrosynthetic routes"]
====

.*Step 3:* Select "Add to pre-existing project" or "Add to a brand new project" 
[%collapsible]
====
If selecting *Add to pre-existing project* then use the dropdown labeled "Filter" to select the project.

image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-06/f1d3d7ed-d12f-4a40-81d1-7ed1b882393f/ascreenshot.jpeg?tl_px=174,161&br_px=1034,642&force_format=png&width=860&wat_scale=76&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=402,212[Screenshot of: Click the "Filter..." field.]
====

.*Step 4:* Select "Target molecule" to specify a molecule
[%collapsible]
====
NOTE: If you have a file containing SMILES strings you may use the "From file" option to upload that file.

image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-06/ecf69718-996a-4f19-86b8-846fd42851fd/ascreenshot.jpeg?tl_px=21,201&br_px=880,682&force_format=png&width=860&wat_scale=76&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=402,212[Screenshot of: Click here.]
====

.*Step 5:* Click "Predict retrosynthetic routes"
[%collapsible]
====
image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-06/c792f2b2-fb55-408f-8f72-212b95f1ca1b/ascreenshot.jpeg?tl_px=428,277&br_px=1288,758&force_format=png&width=860&wat_scale=76&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=402,248[Screenshot of: Click "Predict retrosynthetic routes"]
====

.*Step 6:* In the visual editor, click "Smiles string editor" at the top of the page
[%collapsible]
====
image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-06/4587690c-ef42-4c8f-9447-72bb02d3cf8d/ascreenshot.jpeg?tl_px=359,0&br_px=1219,480&force_format=png&width=860&wat_scale=76&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=402,-8[Screenshot of: Click "Smiles string editor"]
====

.*Step 7:* Copy and paste a SMILES string into the text box.
[%collapsible]
====
On this page, you will paste a SMILES string representing the "target" molecule for the retrosynthesis. Use the one shown below. 

========
The following SMILES string is for a molecule named *paliperidone palmitate* (brand name Invega Sustenna).

`CCCCCCCCCCCCCCCC(=O)OC1CCCN2C1=NC(=C(C2=O)CCN3CCC(CC3)C4=NOC5=C4C=CC(=C5)F)C`

This compound is the active ingredient in medication used to treat schizophrenia and other psychotic disorders.
========

image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-06/bc8bdd76-4b07-4911-8f78-57c8da857b4e/ascreenshot.jpeg?tl_px=153,0&br_px=1012,480&force_format=png&width=860&wat_scale=76&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=402,138[Screenshot of: Click this field.]
====

.*Step 8:* Click "Validate string smiles" to validate the structure in the SMILES string
[%collapsible]
====
image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-06/a0fe68fc-6385-4263-b26c-0b1f2d31d6a5/ascreenshot.jpeg?tl_px=19,277&br_px=879,758&force_format=png&width=860&wat_scale=76&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=402,216[Screenshot of: Click "Validate string smiles"]
====

.*Step 9:* Click "Load in visual editor" to view a visual model of the molecule
[%collapsible]
====
image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-06/fb98a000-8405-4795-b3fc-c7499bbb9edd/ascreenshot.jpeg?tl_px=439,277&br_px=1299,758&force_format=png&width=860&wat_scale=76&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=402,214[Screenshot of: Click "Load in visual editor"]
====

.*Step 10:* After viewing the molecule in the visual editor, click "Predict retrosynthetic route"
[%collapsible]
====
image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-06/fe5f1210-7ec5-49e5-aa39-22ae33f19b8b/ascreenshot.jpeg?tl_px=740,0&br_px=1600,480&force_format=png&width=860&wat_scale=76&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=653,-10[Screenshot of: Click "Predict retrosynthetic route"]
====

.*Step 11:* Select "Automatic mode" in the dialog box 
[%collapsible]
====
There is no difference in the outcome of the analysis between *Automatic* mode and *Interactive* mode, but they each provide a different way of interacting with the results.
[NOTE]
======
*Automatic mode*: All of the most likely reactions and their reagents are predicted and presented in a list, allowing you to navigate and view each of the predicted retrosynthetic routes. 

*Interactive mode*: The interactive mode allows you to select step-by-step the reagents and reaction steps that you would like to use.   
======

image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-06/92798f07-aa13-450a-b1b8-a1e11a7ca59c/ascreenshot.jpeg?tl_px=176,145&br_px=1036,626&force_format=png&width=860&wat_scale=76&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=402,212[Screenshot of: Click here.]
====

.*Step 12:* Under "Choose AI model category" select *AIZ*
[%collapsible]
====
After selecting the AIZ model, select the first option under "Choose AI model version".

NOTE: AIZ and RXN are both machine learning models that have been trained on slightly different data sets.  Both of these models are powerful tools for retrosynthetic analysis.  

After selecting the AI model version, you may move the slide control labeled "Speed/Quality Tuning" to set a balance between how rapidly results are completed versus how exhaustive the search is. 

image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-06/a0292f0b-1beb-4ec5-b280-92e3109dd1ab/ascreenshot.jpeg?tl_px=178,209&br_px=1038,690&force_format=png&width=860&wat_scale=76&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=402,212[Screenshot of: Click here.]
====

.*Step 13:* Click the "Show Advanced Options" check box
[%collapsible]
====
Adjust the MSSR slide controller to a value between 2 and 15.

NOTE: MSSR is the *Minimum Sum of Squared Running Digital Sum*. Lower values indicate that you want only those results that more closely fit the underlying machine learning models.  Higher values indicate that you want to include analyses that have a higher discrepancy between the data and machine learning models. 

image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-06/0e8b4ab6-1ca5-4863-8fdb-0219961fe67f/ascreenshot.jpeg?tl_px=22,146&br_px=882,627&force_format=png&width=860&wat_scale=76&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=402,212[Screenshot of: Click "Show Advanced Options"]
====

.*Step 14:* Click "Predict Retrosynthetic Route" to begin the analysis
[%collapsible]
====
image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-06/6be4a9bd-afa7-4e1f-9a29-08fc49ff55d0/ascreenshot.jpeg?tl_px=446,277&br_px=1306,758&force_format=png&width=860&wat_scale=76&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=402,364[Screenshot of: Click "Predict Retrosynthetic Route"]
====

.*Step 15:* Click "Back to Retrosynthetic Routes"
[%collapsible]
====
This will take you back to a page containing a listing of any previously computed retrosynthesis analyses.

TIP: The computation of all of the retrosynthesis reactions may take some time (up to 10 minutes) depending on several factors, including (but not limited to) molecular complexity, MSSR setting, and selection of machine learning model.  

image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-06/deacb1e7-a94f-4536-ad36-dfda51271a03/ascreenshot.jpeg?tl_px=354,262&br_px=1214,743&force_format=png&width=860&wat_scale=76&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=402,212[Screenshot of: Click "Back to Retrosynthetic Routes"]
====

.*Step 16:* Start from the RXN for Chemistry Home view
[%collapsible]
====

NOTE: The retrosynthesis computations may take several minutes. You can log off from RXN for Chemistry anytime and return to the Home page later to view the results.  

Navigate to the RXN for Chemistry Home page at https://rxn.app.accelerate.science/rxn/home.  

If you are already logged into RXN for Chemisty click on the "Home" link in the left-hand sidebar.

====

.*Step 17:* From Home page, click "Projects"
[%collapsible]
====
image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-10/8e29f93b-e969-40e6-ae82-6565c33c4126/ascreenshot.jpeg?tl_px=0,0&br_px=1075,600&force_format=png&wat_scale=95&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=52,113[Screenshot of: Click "Projects"]
====

.*Step 18:* Click on the Project containing the retrosynthesis analysis.
[%collapsible]
====

image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-10/c3be5b16-5e98-481d-b481-86ef2b2add9a/ascreenshot.jpeg?tl_px=0,203&br_px=1075,804&force_format=png&wat_scale=95&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=493,282[Screenshot of: Click "Ray Lopez"]
====

.*Step 19:* Select "AI Predictions" from the top menu, then "Retrosynthetic routes"
[%collapsible]
====

image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-10/39fbbe3a-dcf3-4e53-a151-4f4f7ab0df76/ascreenshot.jpeg?tl_px=298,0&br_px=1373,600&force_format=png&wat_scale=95&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=502,117[Screenshot of: Click "Retrosynthetic routes"]

====

.*Step 20:* From the *Retrosynthetic routes* listing select the analysis you wish to view.
[%collapsible]
====
image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-10/8793e968-8906-45ce-8945-dea4f01ce9e7/ascreenshot.jpeg?tl_px=253,39&br_px=1328,640&force_format=png&wat_scale=95&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=502,265[Screenshot of: Click "demo project 1_20230922_18:29:46.815"]
====

.*Step 21:* Click on the zoom buttons for zooming in and out 
[%collapsible]
====

image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-10/72c2c708-1ca0-410a-8b50-36816da8be2a/ascreenshot.jpeg?tl_px=150,203&br_px=1225,804&force_format=png&wat_scale=95&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=502,525[Screenshot of: Click here.]

====

.*Step 22:* Click on the icon shown below to view Alternative Reactions (if any) and then close Alternative Reactions sidebar 
[%collapsible]
====

NOTE: Alternative Reactions are those reactions that may occur with lower probabiliity than the main reactions shown.

image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-10/b71b4f42-57e8-475d-85c3-2e242ff1a454/ascreenshot.jpeg?tl_px=265,141&br_px=1340,742&force_format=png&wat_scale=95&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=502,265[Screenshot of: Click here.]

====

.*Step 23:* Click on the dropdown list in the upper left of the screen 
[%collapsible]
====

This option will allow you to view the different reaction sequences identified by RXN for Chemistry.

image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-10/231971c5-5181-4b65-b398-83ac38cf2f6b/ascreenshot.jpeg?tl_px=0,0&br_px=1075,600&force_format=png&wat_scale=95&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=218,185[Screenshot of: Click here.]
====

.*Step 24:* Click on the TMAP icon
[%collapsible]
====
This will take you to a visual TMAP showing your retrosynthesis results in the context of other chemical structures and properties. 

[NOTE]
========

*What is a TMAP?*

TMAP (TreeMAP) is a set of algorithms to help visualize high-dimensional data sets containing chemical structures. It visualizes such data while preserving both global and local features with a sufficient level of detail to allow for human inspection and interpretation.

For more information on TMAPs, see the following:

* https://jcheminf.biomedcentral.com/articles/10.1186/s13321-020-0416-x[Journal of Cheminformatics paper on TMAP]
* http://tmap.gdb.tools/[Documentation for Python TMAP library]

========

image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-10/c13f9631-ecec-453b-91a8-31175642b61d/ascreenshot.jpeg?tl_px=364,0&br_px=1440,600&force_format=png&wat_scale=95&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=888,53[Screenshot of: Click here.]

====

.*Step 25:* After reading the TMAP guidance, click "Continue with TMAP"
[%collapsible]
====

image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-10/8feddb2e-c133-4240-8ad2-50e15dc87c85/ascreenshot.jpeg?tl_px=305,203&br_px=1380,804&force_format=png&wat_scale=95&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=502,457[Screenshot of: Click "Continue with TMAP"]

====

.*Step 26:* Click on the +/- zoom icons to zoom in and out of TMAP
[%collapsible]
====

NOTE: The legend on the right hand side of the TMAP shows you the colors used to represent your reactions most closely related neighbors in the TMAP.

image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-10/0a72ec90-a723-4b92-b40c-d988e2fc7caf/ascreenshot.jpeg?tl_px=109,203&br_px=1184,804&force_format=png&wat_scale=95&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=502,517[Screenshot of: Click this icon.]
====

.*Step 27:* Click on the "X" in the upper right of the screen to close the TMAP 
[%collapsible]
====
After you have finished exploring the TMAP, close it to return to the reactions view.

image:https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2023-10-10/f1613317-902f-480a-a8b8-b17bd50e7e10/ascreenshot.jpeg?tl_px=364,0&br_px=1440,600&force_format=png&wat_scale=95&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=1010,-8[Screenshot of: Click here.]
====

.*Step 28:* Tutorial completed 
[%collapsible]
====
*This completes the Predict Retrosynthesis tutorial for RXN for Chemistry.*

In this tutorial, we:

* Executed a retrosynthesis analysis
* Viewed the results in a Project
* Viewed the details of the predicted retrosynthesis reactions
* Viewed the TreeMAP of retrosynthesis reactions
==== 

include::rxn-footer.adoc[]

=======
